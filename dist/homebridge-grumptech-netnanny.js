import*as e from"crypto";import*as t from"child_process";import*as r from"buffer";import*as n from"node:fs";import*as o from"node:os";import*as i from"node:path";var s={227:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(o=n))})),t.splice(o,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(447)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},447:(e,t,r)=>{e.exports=function(e){function t(e){let r,o,i,s=null;function a(...e){if(!a.enabled)return;const n=a,o=Number(new Date),i=o-(r||o);n.diff=i,n.prev=r,n.curr=o,r=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,o)=>{if("%%"===r)return"%";s++;const i=t.formatters[o];if("function"==typeof i){const t=e[s];r=i.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},187:e=>{var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(r,n){function o(r){e.removeListener(t,i),n(r)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),r([].slice.call(arguments))}g(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,o)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function l(e,t,r,n){var o,i,s,l;if(a(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]),void 0===s)s=i[t]=r,++e._eventsCount;else if("function"==typeof s?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(o=c(e))>0&&s.length>o&&!s.warned){s.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=s.length,l=d,console&&console.warn&&console.warn(l)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=d.bind(n);return o.listener=r,n.wrapFn=o,o}function u(e,t,r){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):f(o,o.length)}function h(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function g(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){n.once&&e.removeEventListener(t,o),r(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var o="error"===e,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var l=c.length,d=f(c,l);for(r=0;r<l;++r)n(d[r],this,t)}return!0},i.prototype.addListener=function(e,t){return l(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return l(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,p(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,p(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,o,i,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return u(this,e,!0)},i.prototype.rawListeners=function(e){return u(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},i.prototype.listenerCount=h,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},284:function(e,t,r){var n,o,i;o=this,i=()=>{const e={VERSION:"1.0.12",not:{},all:{},any:{}},t=Object.prototype.toString,n=Array.prototype.slice,o=Object.prototype.hasOwnProperty,i=e=>(...t)=>!e(...n.call(t)),s=e=>(...t)=>{const r=d(t);for(const t of r)if(!e.call(null,t))return!1;return!0},a=e=>(...t)=>{const r=d(t);for(const t of r)if(e.call(null,t))return!0;return!1},c={"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">":(e,t)=>e>t,">=":(e,t)=>e>=t},l=(e,t)=>{const r=`${t}`,n=+(r.match(/\d+/)||NaN),o=r.match(/^[<>]=?|/)[0];return c[o]?c[o](e,n):e==n||n!=n},d=t=>{let r=n.call(t);return 1===r.length&&e.array(r[0])&&(r=r[0]),r};e.arguments=e=>"[object Arguments]"===t.call(e)||null!=e&&"object"==typeof e&&"callee"in e,e.array=e=>Array.isArray(e)&&"[object Array]"===t.call(e),e.boolean=e=>(!0===e||!1===e)&&new Boolean(e)instanceof Boolean&&"[object Boolean]"===t.call(e),e.char=t=>e.string(t)&&1===t.length,e.date=r=>new Date(r)instanceof Date&&e.not.nan(r)&&"[object Date]"===t.call(r),e.domNode=t=>e.object(t)&&t.nodeType>0,e.error=e=>"[object Error]"===t.call(e),e.function=e=>"[object Function]"===t.call(e)||"function"==typeof e,e.json=e=>"[object Object]"===t.call(e),e.nan=e=>Number.isNaN(e),e.null=e=>null===e,e.number=e=>new Number(e)instanceof Number&&"number"==typeof e&&Number.isFinite(e),e.object=e=>Object(e)===e,e.regexp=e=>"[object RegExp]"===t.call(e),e.sameType=(r,n)=>{const o=t.call(r);return o===t.call(n)&&("[object Number]"!==o||!e.any.nan(r,n)||e.all.nan(r,n))},e.sameType.api=["not"],e.string=e=>new String(e)instanceof String&&"string"==typeof e&&"[object String]"===t.call(e),e.undefined=e=>void 0===e,e.windowObject=e=>null!=e&&"object"==typeof e&&"setInterval"in e,e.stream=e=>null!==e&&"object"==typeof e&&"function"==typeof e.pipe,e.duplexStream=t=>e.writeableStream(t)&&e.readableStream(t),e.readableStream=t=>e.stream(t)&&!1!==t.readable&&"function"==typeof t._read&&"object"==typeof t._readableState,e.transformStream=t=>e.duplexStream(t)&&"function"==typeof t._transform,e.writeableStream=t=>e.stream(t)&&!1!==t.writable&&"function"==typeof t._write&&"object"==typeof t._writableState,e.empty=t=>{if(e.object(t)){const r=Object.getOwnPropertyNames(t).length;return!!(0===r||1===r&&e.array(t)||2===r&&e.arguments(t))}return""===t},e.map=e=>{const t=e.constructor?e.constructor+"":"";return/^function\s+Map\b/.test(t)},e.existy=e=>null!=e,e.falsy=e=>!e,e.truthy=i(e.falsy),e.above=(t,r)=>e.all.number(t,r)&&t>r,e.above.api=["not"],e.decimal=t=>e.number(t)&&t%1!=0,e.equal=(t,r)=>e.all.array(t,r)?t.length===r.length&&t.every((e=>r.includes(e))):e.all.object(t,r)?JSON.stringify(t)===JSON.stringify(r):e.all.number(t,r)?t===r&&1/t==1/r:e.all.string(t,r)||e.all.regexp(t,r)?`${t}`==`${r}`:!!e.all.boolean(t,r)&&t===r,e.equal.api=["not"],e.even=t=>e.number(t)&&t%2==0,e.finite=isFinite||(t=>e.not.infinite(t)&&e.not.nan(t)),e.infinite=e=>e===1/0||e===-1/0,e.integer=e=>Number.isInteger(e),e.negative=t=>e.number(t)&&t<0,e.odd=t=>e.number(t)&&(t%2==1||t%2==-1),e.positive=t=>e.number(t)&&t>0,e.under=(t,r)=>e.all.number(t,r)&&t<r,e.under.api=["not"],e.within=(t,r,n)=>e.all.number(t,r,n)&&t>r&&t<n,e.within.api=["not"];const p={affirmative:/^(?:1|t(?:rue)?|y(?:es)?|ok(?:ay)?)$/,alphaNumeric:/^[A-Za-z0-9]+$/,caPostalCode:/^(?!.*[DFIOQU])[A-VXY][0-9][A-Z]\s?[0-9][A-Z][0-9]$/,crawler:new RegExp("^.*("+["\\+https:\\/\\/developers.google.com\\/\\+\\/web\\/snippet\\/","ad\\smonitoring","adsbot","apex","applebot","archive.org_bot","baiduspider","bingbot","chromeheadless","cloudflare","cloudinary","crawler","curl","discordbot","duckduckbot","embedly","exabot","facebookexternalhit","facebot","flipboard","google","googlebot","gsa-crawler","gurujibot","guzzlehttp","heritrix","ia_archiver","insights","linkedinbot","ltx71","mediapartners","msnbot","odklbot","phantom\\.js","phantomjs","pingdom","pinterest","python","rtlnieuws","skypeuripreview","slackbot","slurp","spbot","telegrambot","test\\scertificate","testing","tiabot","tumblr ","twitterbot","vkshare","web\\sscraper","wget","yandexbot","whatsapp","orangebot","smtbot","qwantify","mj12bot","ahrefsbot","seznambot","panscient.com","duckduckgo-favicons-bot","uptimerobot","semrushbot","postman","dotbot","zoominfobot","ifttt","sogou","ru_bot","researchscan","nimbostratus-bot","slack-imgproxy","node-superagent","go-http-client","jersey","dataprovider.com","github-camo","dispatch","checkmarknetwork","screaming frog","whatweb","daum","netcraftsurveyagent","mojeekbot","surdotlybot","springbot"].join("|")+").*$","i"),creditCard:/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/,dateString:/^(1[0-2]|0?[1-9])([/-])(3[01]|[12][0-9]|0?[1-9])(?:\2)(?:[0-9]{2})?[0-9]{2}$/,email:/^[a-zA-Z0-9][-_.+!#$%&'*/=?^`{|]{0,1}([a-zA-Z0-9][-_.+!#$%&'*/=?^`{|]{0,1})*[a-zA-Z0-9]@[a-zA-Z0-9][-.]{0,1}([a-zA-Z][-.]{0,1})*[a-zA-Z0-9]\.[a-zA-Z0-9]{1,}([.-]{0,1}[a-zA-Z]){0,}[a-zA-Z0-9]{0,}$/i,eppPhone:/^\+[0-9]{1,3}\.[0-9]{4,14}(?:x.+)?$/,hexadecimal:/^(?:0x)?[0-9a-fA-F]+$/,hexColor:/^#?([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,ipv4:/^(?:(?:\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.){3}(?:\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])$/,ipv6:/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i,macAddress:/^([0-9a-f]{2}[-:]){5}[0-9a-f]{2}$/i,nanpPhone:/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,socialSecurityNumber:/^(?!000|666)[0-8][0-9]{2}-?(?!00)[0-9]{2}-?(?!0000)[0-9]{4}$/,timeString:/^(2[0-3]|[01]?[0-9]):([0-5]?[0-9]):([0-5]?[0-9])$/,ukPostCode:/^[A-Z]{1,2}[0-9RCHNQ][0-9A-Z]?\s?[0-9][ABD-HJLNP-UW-Z]{2}$|^[A-Z]{2}-?[0-9]{4}$/,url:/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/i,usZipCode:/^[0-9]{5}(?:-[0-9]{4})?$/},u=(t,r)=>{e[t]=n=>e.existy(n)&&r[t].test(n)};for(const e in p)Object.prototype.hasOwnProperty.call(p,e)&&u(e,p);e.ip=t=>e.ipv4(t)||e.ipv6(t),e.capitalized=t=>{if(e.not.string(t))return!1;const r=t.split(" ");for(const e of r)if(e.length){const t=e.charAt(0);if(t!==t.toUpperCase())return!1}return!0},e.endWith=(t,r)=>{if(e.not.string(t))return!1;r+="";const n=t.length-r.length;return n>=0&&t.indexOf(r,n)===n},e.endWith.api=["not"],e.include=(e,t)=>e.includes(t),e.include.api=["not"],e.umlaut=t=>e.string(t)&&e.array(t.match(/[\u00c4\u00e4\u00d6\u00f6\u00dc\u00fc\u00df]/g)),e.lowerCase=t=>e.string(t)&&t===t.toLowerCase(),e.palindrome=t=>!e.not.string(t)&&(t=t.replace(/[^a-zA-Z0-9]+/g,"").toLowerCase()).split("").every(((e,r)=>e===t[t.length-1-r])),e.space=t=>{if(e.not.char(t))return!1;const r=t.charCodeAt(0);return r>8&&r<14||32===r},e.startWith=(t,r)=>e.string(t)&&0===t.indexOf(r),e.startWith.api=["not"],e.upperCase=t=>e.string(t)&&t===t.toUpperCase();const h=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],f=["january","february","march","april","may","june","july","august","september","october","november","december"];e.day=(t,r)=>e.date(t)&&r.toLowerCase()===h[t.getDay()],e.day.api=["not"],e.dayLightSavingTime=e=>{const t=new Date(e.getFullYear(),0,1),r=new Date(e.getFullYear(),6,1),n=Math.max(t.getTimezoneOffset(),r.getTimezoneOffset());return e.getTimezoneOffset()<n},e.future=t=>{const r=new Date;return e.date(t)&&t.getTime()>r.getTime()},e.inDateRange=(t,r,n)=>{if(e.not.date(t)||e.not.date(r)||e.not.date(n))return!1;const o=t.getTime();return o>r.getTime()&&o<n.getTime()},e.inDateRange.api=["not"],e.inLastMonth=t=>e.inDateRange(t,new Date((new Date).setMonth((new Date).getMonth()-1)),new Date),e.inLastWeek=t=>e.inDateRange(t,new Date((new Date).setDate((new Date).getDate()-7)),new Date),e.inLastYear=t=>e.inDateRange(t,new Date((new Date).setFullYear((new Date).getFullYear()-1)),new Date),e.inNextMonth=t=>e.inDateRange(t,new Date,new Date((new Date).setMonth((new Date).getMonth()+1))),e.inNextWeek=t=>e.inDateRange(t,new Date,new Date((new Date).setDate((new Date).getDate()+7))),e.inNextYear=t=>e.inDateRange(t,new Date,new Date((new Date).setFullYear((new Date).getFullYear()+1))),e.leapYear=t=>e.number(t)&&(t%4==0&&t%100!=0||t%400==0),e.month=(t,r)=>e.date(t)&&r.toLowerCase()===f[t.getMonth()],e.month.api=["not"],e.past=t=>{const r=new Date;return e.date(t)&&t.getTime()<r.getTime()},e.quarterOfYear=(t,r)=>e.date(t)&&e.number(r)&&r===Math.floor((t.getMonth()+3)/3),e.quarterOfYear.api=["not"],e.today=t=>{const r=(new Date).toDateString();return e.date(t)&&t.toDateString()===r},e.tomorrow=t=>{const r=new Date,n=new Date(r.setDate(r.getDate()+1)).toDateString();return e.date(t)&&t.toDateString()===n},e.weekend=t=>e.date(t)&&(6===t.getDay()||0===t.getDay()),e.weekday=i(e.weekend),e.year=(t,r)=>e.date(t)&&e.number(r)&&r===t.getFullYear(),e.year.api=["not"],e.yesterday=t=>{const r=new Date,n=new Date(r.setDate(r.getDate()-1)).toDateString();return e.date(t)&&t.toDateString()===n};const g=e.windowObject("object"==typeof r.g&&r.g)&&r.g,m=e.windowObject("object"==typeof self&&self)&&self,y=e.windowObject("object"==typeof this&&this)&&this,_=g||m||y||Function("return this")(),b=m&&m.document,w=_.is,v=m?.navigator,C=(v?.userAgentData?.platform||v?.platform||"").toLowerCase(),E=(v?.userAgent||"").toLowerCase(),O=(v?.vendor||"").toLowerCase();return e.browser=()=>"undefined"!=typeof window&&void 0!==window.document,e.browser.api=["not"],e.nodejs=()=>"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,e.nodejs.api=["not"],e.deno=()=>!1,e.deno.api=["not"],e.webworker=()=>"object"==typeof self&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,e.webworker.api=["not"],e.android=()=>/android/.test(E),e.android.api=["not"],e.androidPhone=()=>/android/.test(E)&&/mobile/.test(E),e.androidPhone.api=["not"],e.androidTablet=()=>/android/.test(E)&&!/mobile/.test(E),e.androidTablet.api=["not"],e.blackberry=()=>/blackberry/.test(E)||/bb10/.test(E),e.blackberry.api=["not"],e.chrome=t=>{const r=/google inc/.test(O)?E.match(/(?:chrome|crios)\/(\d+)/):null;return null!==r&&e.not.opera()&&l(r[1],t)},e.chrome.api=["not"],e.desktop=()=>e.not.mobile()&&e.not.tablet(),e.desktop.api=["not"],e.edge=e=>{const t=E.match(/edg(e|a|ios)?\/(\d+)/);return null!==t&&l(t[1],e)},e.edge.api=["not"],e.firefox=e=>{const t=E.match(/(?:firefox|fxios)\/(\d+)/);return null!==t&&l(t[1],e)},e.firefox.api=["not"],e.ie=e=>{const t=E.match(/(?:msie |trident.+?; rv:)(\d+)/);return null!==t&&l(t[1],e)},e.ie.api=["not"],e.ios=()=>e.iphone()||e.ipad()||e.ipod(),e.ios.api=["not"],e.ipad=e=>{const t=E.match(/\(ipad.*os (\d+)[._](\d+)/)||(E.includes("mac")&&"ontouchend"in b?E.match(/version\/(\d+)/):null);return null!==t&&l(t[1],e)},e.ipad.api=["not"],e.iphone=e=>{const t=E.match(/\(iphone.*os (\d+)[._](\d+)/);return null!==t&&l(t[1]||1,e)},e.iphone.api=["not"],e.ipod=e=>{const t=E.match(/ipod.+?os (\d+)/);return null!==t&&l(t[1],e)},e.ipod.api=["not"],e.linux=()=>/linux/.test(C)&&e.not.android(),e.linux.api=["not"],e.mac=()=>/mac/.test(C),e.mac.api=["not"],e.mobile=()=>e.iphone()||e.ipod()||e.androidPhone()||e.blackberry()||e.windowsPhone(),e.mobile.api=["not"],e.offline=i(e.online),e.offline.api=["not"],e.online=()=>!v||!0===v.onLine,e.online.api=["not"],e.opera=e=>{const t=E.match(/(?:^opera.+?version|opr)\/(\d+)/);return null!==t&&l(t[1],e)},e.opera.api=["not"],e.operaMini=e=>{const t=E.match(/opera mini\/(\d+)/);return null!==t&&l(t[1],e)},e.operaMini.api=["not"],e.phantom=e=>{const t=E.match(/phantomjs\/(\d+)/);return null!==t&&l(t[1],e)},e.phantom.api=["not"],e.safari=e=>{const t=E.match(/version\/(\d+)((?!chrome).)+?safari/);return null!==t&&l(t[1],e)},e.safari.api=["not"],e.tablet=()=>e.ipad()||e.androidTablet()||e.windowsTablet(),e.tablet.api=["not"],e.touchDevice=()=>!!b&&("ontouchstart"in m||"DocumentTouch"in m&&b instanceof DocumentTouch),e.touchDevice.api=["not"],e.windows=()=>/win/.test(C),e.windows.api=["not"],e.windowsPhone=()=>e.windows()&&/phone/.test(E),e.windowsPhone.api=["not"],e.windowsTablet=()=>e.windows()&&e.not.windowsPhone()&&/touch/.test(E),e.windowsTablet.api=["not"],e.propertyCount=(t,r)=>{if(e.not.object(t)||e.not.number(r))return!1;let n=0;for(const e in t)if(o.call(t,e)&&++n>r)return!1;return n===r},e.propertyCount.api=["not"],e.propertyDefined=(t,r)=>e.object(t)&&e.string(r)&&r in t,e.propertyDefined.api=["not"],e.thenable=t=>e.object(t)&&"function"==typeof t.then,e.inArray=(t,r)=>!e.not.array(r)&&r.includes(t),e.inArray.api=["not"],e.sorted=(t,r)=>{if(e.not.array(t))return!1;const n=c[r]||c[">="];for(const[e]of t.entries())if(e>=1&&!n(t[e],t[e-1]))return!1;return!0},(()=>{const t=e;for(const r in t)if(o.call(t,r)&&e.function(t[r])){const n=t[r].api||["not","all","any"];for(const t of n)"not"===t&&(e.not[r]=i(e[r])),"all"===t&&(e.all[r]=s(e[r])),"any"===t&&(e.any[r]=a(e[r]))}})(),e.setNamespace=()=>(_.is=w,this),e.setRegexp=(e,t)=>{for(const r in p)o.call(p,r)&&t===r&&(p[r]=e)},e},void 0===(n=(()=>o.is=i()).call(t,r,t,e))||(e.exports=n)},824:e=>{var t=1e3,r=60*t,n=60*r,o=24*n;function i(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}e.exports=function(e,s){s=s||{};var a,c,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(i){var s=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*n;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===l&&isFinite(e))return s.long?(a=e,(c=Math.abs(a))>=o?i(a,c,o,"day"):c>=n?i(a,c,n,"hour"):c>=r?i(a,c,r,"minute"):c>=t?i(a,c,t,"second"):a+" ms"):function(e){var i=Math.abs(e);return i>=o?Math.round(e/o)+"d":i>=n?Math.round(e/n)+"h":i>=r?Math.round(e/r)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}},a={};function c(e){var t=a[e];if(void 0!==t)return t.exports;var r=a[e]={exports:{}};return s[e].call(r.exports,r,r.exports,c),r.exports}c.d=(e,t)=>{for(var r in t)c.o(t,r)&&!c.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},c.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var l={};(()=>{c.d(l,{Z:()=>W});var s=c(227),a=c(187);const d=(p={createHash:()=>e.createHash},u={},c.d(u,p),u);var p,u,h=c(284);const f=(e=>{var t={};return c.d(t,e),t})({spawn:()=>t.spawn}),g=(e=>{var t={};return c.d(t,e),t})({Buffer:()=>r.Buffer});var m={227:(e,t,r)=>{t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,o=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(o=n))})),t.splice(o,0,r)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=r(447)(t);const{formatters:n}=e.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},447:(e,t,r)=>{e.exports=function(e){function t(e){let r,o,i,s=null;function a(...e){if(!a.enabled)return;const n=a,o=Number(new Date),i=o-(r||o);n.diff=i,n.prev=r,n.curr=o,r=o,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let s=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,o)=>{if("%%"===r)return"%";s++;const i=t.formatters[o];if("function"==typeof i){const t=e[s];r=i.call(n,t),e.splice(s,1),s--}return r})),t.formatArgs.call(n,e),(n.log||t.log).apply(n,e)}return a.namespace=e,a.useColors=t.useColors(),a.color=t.selectColor(e),a.extend=n,a.destroy=t.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(o!==t.namespaces&&(o=t.namespaces,i=t.enabled(e)),i),set:e=>{s=e}}),"function"==typeof t.init&&t.init(a),a}function n(e,r){const n=t(this.namespace+(void 0===r?":":r)+e);return n.log=this.log,n}function o(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(o),...t.skips.map(o).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let r;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const n=("string"==typeof e?e:"").split(/[\s,]+/),o=n.length;for(r=0;r<o;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.slice(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let r,n;for(r=0,n=t.skips.length;r<n;r++)if(t.skips[r].test(e))return!1;for(r=0,n=t.names.length;r<n;r++)if(t.names[r].test(e))return!0;return!1},t.humanize=r(824),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((r=>{t[r]=e[r]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let r=0;for(let t=0;t<e.length;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return t.colors[Math.abs(r)%t.colors.length]},t.enable(t.load()),t}},187:e=>{var t,r="object"==typeof Reflect?Reflect:null,n=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,t){return new Promise((function(r,n){function o(r){e.removeListener(t,i),n(r)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),r([].slice.call(arguments))}g(e,t,i,{once:!0}),"error"!==t&&function(e,t,r){"function"==typeof e.on&&g(e,"error",t,{once:!0})}(e,o)}))},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function l(e,t,r,n){var o,i,s,l;if(a(r),void 0===(i=e._events)?(i=e._events=Object.create(null),e._eventsCount=0):(void 0!==i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]),void 0===s)s=i[t]=r,++e._eventsCount;else if("function"==typeof s?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),(o=c(e))>0&&s.length>o&&!s.warned){s.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=s.length,l=d,console&&console.warn&&console.warn(l)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},o=d.bind(n);return o.listener=r,n.wrapFn=o,o}function u(e,t,r){var n=e._events;if(void 0===n)return[];var o=n[t];return void 0===o?[]:"function"==typeof o?r?[o.listener||o]:[o]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(o):f(o,o.length)}function h(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function g(e,t,r,n){if("function"==typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function o(i){n.once&&e.removeEventListener(t,o),r(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return c(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var o="error"===e,i=this._events;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)n(c,this,t);else{var l=c.length,d=f(c,l);for(r=0;r<l;++r)n(d[r],this,t)}return!0},i.prototype.addListener=function(e,t){return l(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return l(this,e,t,!0)},i.prototype.once=function(e,t){return a(t),this.on(e,p(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,p(this,e,t)),this},i.prototype.removeListener=function(e,t){var r,n,o,i,s;if(a(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(o=-1,i=r.length-1;i>=0;i--)if(r[i]===t||r[i].listener===t){s=r[i].listener,o=i;break}if(o<0)return this;0===o?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,o),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var o,i=Object.keys(r);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},i.prototype.listeners=function(e){return u(this,e,!0)},i.prototype.rawListeners=function(e){return u(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},i.prototype.listenerCount=h,i.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},284:function(e,t,r){var n,o,i;o=this,i=()=>{const e={VERSION:"1.0.11",not:{},all:{},any:{}},t=Object.prototype.toString,n=Array.prototype.slice,o=Object.prototype.hasOwnProperty,i=e=>(...t)=>!e(...n.call(t)),s=e=>(...t)=>{const r=d(t);for(const t of r)if(!e.call(null,t))return!1;return!0},a=e=>(...t)=>{const r=d(t);for(const t of r)if(e.call(null,t))return!0;return!1},c={"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,">":(e,t)=>e>t,">=":(e,t)=>e>=t},l=(e,t)=>{const r=`${t}`,n=+(r.match(/\d+/)||NaN),o=r.match(/^[<>]=?|/)[0];return c[o]?c[o](e,n):e==n||n!=n},d=t=>{let r=n.call(t);return 1===r.length&&e.array(r[0])&&(r=r[0]),r};e.arguments=e=>"[object Arguments]"===t.call(e)||null!=e&&"object"==typeof e&&"callee"in e,e.array=e=>Array.isArray(e)&&"[object Array]"===t.call(e),e.boolean=e=>(!0===e||!1===e)&&new Boolean(e)instanceof Boolean&&"[object Boolean]"===t.call(e),e.char=t=>e.string(t)&&1===t.length,e.date=r=>new Date(r)instanceof Date&&e.not.nan(r)&&"[object Date]"===t.call(r),e.domNode=t=>e.object(t)&&t.nodeType>0,e.error=e=>"[object Error]"===t.call(e),e.function=e=>"[object Function]"===t.call(e)||"function"==typeof e,e.json=e=>"[object Object]"===t.call(e),e.nan=e=>Number.isNaN(e),e.null=e=>null===e,e.number=e=>new Number(e)instanceof Number&&"number"==typeof e&&Number.isFinite(e),e.object=e=>Object(e)===e,e.regexp=e=>"[object RegExp]"===t.call(e),e.sameType=(r,n)=>{const o=t.call(r);return o===t.call(n)&&("[object Number]"!==o||!e.any.nan(r,n)||e.all.nan(r,n))},e.sameType.api=["not"],e.string=e=>new String(e)instanceof String&&"string"==typeof e&&"[object String]"===t.call(e),e.undefined=e=>void 0===e,e.windowObject=e=>null!=e&&"object"==typeof e&&"setInterval"in e,e.stream=e=>null!==e&&"object"==typeof e&&"function"==typeof e.pipe,e.duplexStream=t=>e.writeableStream(t)&&e.readableStream(t),e.readableStream=t=>e.stream(t)&&!1!==t.readable&&"function"==typeof t._read&&"object"==typeof t._readableState,e.transformStream=t=>e.duplexStream(t)&&"function"==typeof t._transform,e.writeableStream=t=>e.stream(t)&&!1!==t.writable&&"function"==typeof t._write&&"object"==typeof t._writableState,e.empty=t=>{if(e.object(t)){const r=Object.getOwnPropertyNames(t).length;return!!(0===r||1===r&&e.array(t)||2===r&&e.arguments(t))}return""===t},e.map=e=>{const t=e.constructor?e.constructor+"":"";return/^function\s+Map\b/.test(t)},e.existy=e=>null!=e,e.falsy=e=>!e,e.truthy=i(e.falsy),e.above=(t,r)=>e.all.number(t,r)&&t>r,e.above.api=["not"],e.decimal=t=>e.number(t)&&t%1!=0,e.equal=(t,r)=>e.all.array(t,r)?t.length===r.length&&t.every((e=>r.includes(e))):e.all.object(t,r)?JSON.stringify(t)===JSON.stringify(r):e.all.number(t,r)?t===r&&1/t==1/r:e.all.string(t,r)||e.all.regexp(t,r)?`${t}`==`${r}`:!!e.all.boolean(t,r)&&t===r,e.equal.api=["not"],e.even=t=>e.number(t)&&t%2==0,e.finite=isFinite||(t=>e.not.infinite(t)&&e.not.nan(t)),e.infinite=e=>e===1/0||e===-1/0,e.integer=e=>Number.isInteger(e),e.negative=t=>e.number(t)&&t<0,e.odd=t=>e.number(t)&&(t%2==1||t%2==-1),e.positive=t=>e.number(t)&&t>0,e.under=(t,r)=>e.all.number(t,r)&&t<r,e.under.api=["not"],e.within=(t,r,n)=>e.all.number(t,r,n)&&t>r&&t<n,e.within.api=["not"];const p={affirmative:/^(?:1|t(?:rue)?|y(?:es)?|ok(?:ay)?)$/,alphaNumeric:/^[A-Za-z0-9]+$/,caPostalCode:/^(?!.*[DFIOQU])[A-VXY][0-9][A-Z]\s?[0-9][A-Z][0-9]$/,crawler:new RegExp("^.*("+["\\+https:\\/\\/developers.google.com\\/\\+\\/web\\/snippet\\/","ad\\smonitoring","adsbot","apex","applebot","archive.org_bot","baiduspider","bingbot","chromeheadless","cloudflare","cloudinary","crawler","curl","discordbot","duckduckbot","embedly","exabot","facebookexternalhit","facebot","flipboard","google","googlebot","gsa-crawler","gurujibot","guzzlehttp","heritrix","ia_archiver","insights","linkedinbot","ltx71","mediapartners","msnbot","odklbot","phantom\\.js","phantomjs","pingdom","pinterest","python","rtlnieuws","skypeuripreview","slackbot","slurp","spbot","telegrambot","test\\scertificate","testing","tiabot","tumblr ","twitterbot","vkshare","web\\sscraper","wget","yandexbot","whatsapp","orangebot","smtbot","qwantify","mj12bot","ahrefsbot","seznambot","panscient.com","duckduckgo-favicons-bot","uptimerobot","semrushbot","postman","dotbot","zoominfobot","ifttt","sogou","ru_bot","researchscan","nimbostratus-bot","slack-imgproxy","node-superagent","go-http-client","jersey","dataprovider.com","github-camo","dispatch","checkmarknetwork","screaming frog","whatweb","daum","netcraftsurveyagent","mojeekbot","surdotlybot","springbot"].join("|")+").*$","i"),creditCard:/^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/,dateString:/^(1[0-2]|0?[1-9])([/-])(3[01]|[12][0-9]|0?[1-9])(?:\2)(?:[0-9]{2})?[0-9]{2}$/,email:/^[a-zA-Z0-9][-_.+!#$%&'*/=?^`{|]{0,1}([a-zA-Z0-9][-_.+!#$%&'*/=?^`{|]{0,1})*[a-zA-Z0-9]@[a-zA-Z0-9][-.]{0,1}([a-zA-Z][-.]{0,1})*[a-zA-Z0-9]\.[a-zA-Z0-9]{1,}([.-]{0,1}[a-zA-Z]){0,}[a-zA-Z0-9]{0,}$/i,eppPhone:/^\+[0-9]{1,3}\.[0-9]{4,14}(?:x.+)?$/,hexadecimal:/^(?:0x)?[0-9a-fA-F]+$/,hexColor:/^#?([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,ipv4:/^(?:(?:\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])\.){3}(?:\d|[1-9]\d|1\d{2}|2[0-4]\d|25[0-5])$/,ipv6:/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i,macAddress:/^([0-9a-f]{2}[-:]){5}[0-9a-f]{2}$/i,nanpPhone:/^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/,socialSecurityNumber:/^(?!000|666)[0-8][0-9]{2}-?(?!00)[0-9]{2}-?(?!0000)[0-9]{4}$/,timeString:/^(2[0-3]|[01]?[0-9]):([0-5]?[0-9]):([0-5]?[0-9])$/,ukPostCode:/^[A-Z]{1,2}[0-9RCHNQ][0-9A-Z]?\s?[0-9][ABD-HJLNP-UW-Z]{2}$|^[A-Z]{2}-?[0-9]{4}$/,url:/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/i,usZipCode:/^[0-9]{5}(?:-[0-9]{4})?$/},u=(t,r)=>{e[t]=n=>e.existy(n)&&r[t].test(n)};for(const e in p)Object.prototype.hasOwnProperty.call(p,e)&&u(e,p);e.ip=t=>e.ipv4(t)||e.ipv6(t),e.capitalized=t=>{if(e.not.string(t))return!1;const r=t.split(" ");for(const e of r)if(e.length){const t=e.charAt(0);if(t!==t.toUpperCase())return!1}return!0},e.endWith=(t,r)=>{if(e.not.string(t))return!1;r+="";const n=t.length-r.length;return n>=0&&t.indexOf(r,n)===n},e.endWith.api=["not"],e.include=(e,t)=>e.includes(t),e.include.api=["not"],e.umlaut=t=>e.string(t)&&e.array(t.match(/[\u00c4\u00e4\u00d6\u00f6\u00dc\u00fc\u00df]/g)),e.lowerCase=t=>e.string(t)&&t===t.toLowerCase(),e.palindrome=t=>!e.not.string(t)&&(t=t.replace(/[^a-zA-Z0-9]+/g,"").toLowerCase()).split("").every(((e,r)=>e===t[t.length-1-r])),e.space=t=>{if(e.not.char(t))return!1;const r=t.charCodeAt(0);return r>8&&r<14||32===r},e.startWith=(t,r)=>e.string(t)&&0===t.indexOf(r),e.startWith.api=["not"],e.upperCase=t=>e.string(t)&&t===t.toUpperCase();const h=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],f=["january","february","march","april","may","june","july","august","september","october","november","december"];e.day=(t,r)=>e.date(t)&&r.toLowerCase()===h[t.getDay()],e.day.api=["not"],e.dayLightSavingTime=e=>{const t=new Date(e.getFullYear(),0,1),r=new Date(e.getFullYear(),6,1),n=Math.max(t.getTimezoneOffset(),r.getTimezoneOffset());return e.getTimezoneOffset()<n},e.future=t=>{const r=new Date;return e.date(t)&&t.getTime()>r.getTime()},e.inDateRange=(t,r,n)=>{if(e.not.date(t)||e.not.date(r)||e.not.date(n))return!1;const o=t.getTime();return o>r.getTime()&&o<n.getTime()},e.inDateRange.api=["not"],e.inLastMonth=t=>e.inDateRange(t,new Date((new Date).setMonth((new Date).getMonth()-1)),new Date),e.inLastWeek=t=>e.inDateRange(t,new Date((new Date).setDate((new Date).getDate()-7)),new Date),e.inLastYear=t=>e.inDateRange(t,new Date((new Date).setFullYear((new Date).getFullYear()-1)),new Date),e.inNextMonth=t=>e.inDateRange(t,new Date,new Date((new Date).setMonth((new Date).getMonth()+1))),e.inNextWeek=t=>e.inDateRange(t,new Date,new Date((new Date).setDate((new Date).getDate()+7))),e.inNextYear=t=>e.inDateRange(t,new Date,new Date((new Date).setFullYear((new Date).getFullYear()+1))),e.leapYear=t=>e.number(t)&&(t%4==0&&t%100!=0||t%400==0),e.month=(t,r)=>e.date(t)&&r.toLowerCase()===f[t.getMonth()],e.month.api=["not"],e.past=t=>{const r=new Date;return e.date(t)&&t.getTime()<r.getTime()},e.quarterOfYear=(t,r)=>e.date(t)&&e.number(r)&&r===Math.floor((t.getMonth()+3)/3),e.quarterOfYear.api=["not"],e.today=t=>{const r=(new Date).toDateString();return e.date(t)&&t.toDateString()===r},e.tomorrow=t=>{const r=new Date,n=new Date(r.setDate(r.getDate()+1)).toDateString();return e.date(t)&&t.toDateString()===n},e.weekend=t=>e.date(t)&&(6===t.getDay()||0===t.getDay()),e.weekday=i(e.weekend),e.year=(t,r)=>e.date(t)&&e.number(r)&&r===t.getFullYear(),e.year.api=["not"],e.yesterday=t=>{const r=new Date,n=new Date(r.setDate(r.getDate()-1)).toDateString();return e.date(t)&&t.toDateString()===n};const g=e.windowObject("object"==typeof r.g&&r.g)&&r.g,m=e.windowObject("object"==typeof self&&self)&&self,y=e.windowObject("object"==typeof this&&this)&&this,_=g||m||y||Function("return this")(),b=m&&m.document,w=_.is,v=m?.navigator,C=(v?.userAgentData?.platform||v?.platform||"").toLowerCase(),E=(v?.userAgent||"").toLowerCase(),O=(v?.vendor||"").toLowerCase();return e.browser=()=>"undefined"!=typeof window&&void 0!==window.document,e.browser.api=["not"],e.nodejs=()=>"undefined"!=typeof process&&null!=process.versions&&null!=process.versions.node,e.nodejs.api=["not"],e.deno=()=>!1,e.deno.api=["not"],e.webworker=()=>"object"==typeof self&&self.constructor&&"DedicatedWorkerGlobalScope"===self.constructor.name,e.webworker.api=["not"],e.android=()=>/android/.test(E),e.android.api=["not"],e.androidPhone=()=>/android/.test(E)&&/mobile/.test(E),e.androidPhone.api=["not"],e.androidTablet=()=>/android/.test(E)&&!/mobile/.test(E),e.androidTablet.api=["not"],e.blackberry=()=>/blackberry/.test(E)||/bb10/.test(E),e.blackberry.api=["not"],e.chrome=t=>{const r=/google inc/.test(O)?E.match(/(?:chrome|crios)\/(\d+)/):null;return null!==r&&e.not.opera()&&l(r[1],t)},e.chrome.api=["not"],e.desktop=()=>e.not.mobile()&&e.not.tablet(),e.desktop.api=["not"],e.edge=e=>{const t=E.match(/edg(e|a|ios)?\/(\d+)/);return null!==t&&l(t[1],e)},e.edge.api=["not"],e.firefox=e=>{const t=E.match(/(?:firefox|fxios)\/(\d+)/);return null!==t&&l(t[1],e)},e.firefox.api=["not"],e.ie=e=>{const t=E.match(/(?:msie |trident.+?; rv:)(\d+)/);return null!==t&&l(t[1],e)},e.ie.api=["not"],e.ios=()=>e.iphone()||e.ipad()||e.ipod(),e.ios.api=["not"],e.ipad=e=>{const t=E.match(/\(ipad.*os (\d+)[._](\d+)/)||(E.includes("mac")&&"ontouchend"in b?E.match(/version\/(\d+)/):null);return null!==t&&l(t[1],e)},e.ipad.api=["not"],e.iphone=e=>{const t=E.match(/\(iphone.*os (\d+)[._](\d+)/);return null!==t&&l(t[1]||1,e)},e.iphone.api=["not"],e.ipod=e=>{const t=E.match(/ipod.+?os (\d+)/);return null!==t&&l(t[1],e)},e.ipod.api=["not"],e.linux=()=>/linux/.test(C)&&e.not.android(),e.linux.api=["not"],e.mac=()=>/mac/.test(C),e.mac.api=["not"],e.mobile=()=>e.iphone()||e.ipod()||e.androidPhone()||e.blackberry()||e.windowsPhone(),e.mobile.api=["not"],e.offline=i(e.online),e.offline.api=["not"],e.online=()=>!v||!0===v.onLine,e.online.api=["not"],e.opera=e=>{const t=E.match(/(?:^opera.+?version|opr)\/(\d+)/);return null!==t&&l(t[1],e)},e.opera.api=["not"],e.operaMini=e=>{const t=E.match(/opera mini\/(\d+)/);return null!==t&&l(t[1],e)},e.operaMini.api=["not"],e.phantom=e=>{const t=E.match(/phantomjs\/(\d+)/);return null!==t&&l(t[1],e)},e.phantom.api=["not"],e.safari=e=>{const t=E.match(/version\/(\d+)((?!chrome).)+?safari/);return null!==t&&l(t[1],e)},e.safari.api=["not"],e.tablet=()=>e.ipad()||e.androidTablet()||e.windowsTablet(),e.tablet.api=["not"],e.touchDevice=()=>!!b&&("ontouchstart"in m||"DocumentTouch"in m&&b instanceof DocumentTouch),e.touchDevice.api=["not"],e.windows=()=>/win/.test(C),e.windows.api=["not"],e.windowsPhone=()=>e.windows()&&/phone/.test(E),e.windowsPhone.api=["not"],e.windowsTablet=()=>e.windows()&&e.not.windowsPhone()&&/touch/.test(E),e.windowsTablet.api=["not"],e.propertyCount=(t,r)=>{if(e.not.object(t)||e.not.number(r))return!1;let n=0;for(const e in t)if(o.call(t,e)&&++n>r)return!1;return n===r},e.propertyCount.api=["not"],e.propertyDefined=(t,r)=>e.object(t)&&e.string(r)&&r in t,e.propertyDefined.api=["not"],e.thenable=t=>e.object(t)&&"function"==typeof t.then,e.inArray=(t,r)=>!e.not.array(r)&&r.includes(t),e.inArray.api=["not"],e.sorted=(t,r)=>{if(e.not.array(t))return!1;const n=c[r]||c[">="];for(const[e]of t.entries())if(e>=1&&!n(t[e],t[e-1]))return!1;return!0},(()=>{const t=e;for(const r in t)if(o.call(t,r)&&e.function(t[r])){const n=t[r].api||["not","all","any"];for(const t of n)"not"===t&&(e.not[r]=i(e[r])),"all"===t&&(e.all[r]=s(e[r])),"any"===t&&(e.any[r]=a(e[r]))}})(),e.setNamespace=()=>(_.is=w,this),e.setRegexp=(e,t)=>{for(const r in p)o.call(p,r)&&t===r&&(p[r]=e)},e},void 0===(n=(()=>o.is=i()).call(t,r,t,e))||(e.exports=n)},824:e=>{var t=1e3,r=60*t,n=60*r,o=24*n;function i(e,t,r,n){var o=t>=1.5*r;return Math.round(e/r)+" "+n+(o?"s":"")}e.exports=function(e,s){s=s||{};var a,c,l=typeof e;if("string"===l&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(i){var s=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*n;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(e);if("number"===l&&isFinite(e))return s.long?(a=e,(c=Math.abs(a))>=o?i(a,c,o,"day"):c>=n?i(a,c,n,"hour"):c>=r?i(a,c,r,"minute"):c>=t?i(a,c,t,"second"):a+" ms"):function(e){var i=Math.abs(e);return i>=o?Math.round(e/o)+"d":i>=n?Math.round(e/n)+"h":i>=r?Math.round(e/r)+"m":i>=t?Math.round(e/t)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}},y={};function _(e){var t=y[e];if(void 0!==t)return t.exports;var r=y[e]={exports:{}};return m[e].call(r.exports,r,r.exports,_),r.exports}_.d=(e,t)=>{for(var r in t)_.o(t,r)&&!_.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},_.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),_.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var b={};(()=>{_.d(b,{RB:()=>u,hA:()=>l,nb:()=>d,ZP:()=>h});var e=_(187),t=_(227);const r=(n={spawn:()=>f.spawn},o={},_.d(o,n),o);var n,o;const i=(s={Buffer:()=>g.Buffer},a={},_.d(a,s),a);var s,a,c=_(284);t("spawn_options").log=console.log.bind(console);const l={SERIALIZATION_JSON:"json",SERIALIZATION_ADVANCED:"advanced"},d=class{constructor(e){if(this._cwd=void 0,this._env=process.env,this._argv0=void 0,this._stdio=void 0,this._detached=!1,this._uid=void 0,this._gid=void 0,this._serialization=l.SERIALIZATION_JSON,this._shell=!1,this._windowsVerbatimArgs=!1,this._windowsHide=!1,this._signal=void 0,this._timeout=void 0,this._killSignal="SIGTERM",c.not.undefined(e))if(c.object(e)){let t=!1;if(Object.prototype.hasOwnProperty.call(e,"testing")&&c.boolean(e.testing)&&(t=e.testing),Object.prototype.hasOwnProperty.call(e,"cwd"))if(c.sameType(e.cwd,"string")||e.cwd instanceof URL)this._cwd=e.cwd;else if(!t)throw new TypeError(`'config.cwd' is not string or URL. type(${typeof e.cwd})`);if(Object.prototype.hasOwnProperty.call(e,"env"))if(c.object(e.env))this._env=e.env;else if(!t)throw new TypeError(`'config.env' is not an object. type(${typeof e.env})`);if(Object.prototype.hasOwnProperty.call(e,"argv0"))if(c.sameType(e.argv0,"string"))this._argv0=e.argv0;else if(!t)throw new TypeError(`'config.argv0' is not string. type(${typeof e.cwd})`);if(Object.prototype.hasOwnProperty.call(e,"stdio"))if(c.sameType(e.stdio,"string")||c.array(e.stdio))this._stdio=e.stdio;else if(!t)throw new TypeError(`'config.stdio' is not string or Array. type(${typeof e.stdio})`);if(Object.prototype.hasOwnProperty.call(e,"detached"))if(c.boolean(e.detached))this._detached=e.detached;else if(!t)throw new TypeError(`'config.detached' is not a boolean. type(${typeof e.detached})`);if(Object.prototype.hasOwnProperty.call(e,"uid"))if(c.number(e.uid))this._uid=e.uid;else if(!t)throw new TypeError(`'config.uid' is not a number. type(${typeof e.uid})`);if(Object.prototype.hasOwnProperty.call(e,"gid"))if(c.number(e.gid))this._gid=e.gid;else if(!t)throw new TypeError(`'config.gid' is not a number. type(${typeof e.gid})`);if(Object.prototype.hasOwnProperty.call(e,"serialization"))if(c.truthy(Object.values(l).indexOf(e.serialization)>=0))this._serialization=e.serialization;else if(!t)throw new TypeError(`'config.serialization' is not a serialization type. type(${typeof e.serialization})`);if(Object.prototype.hasOwnProperty.call(e,"shell"))if(c.boolean(e.shell)||c.sameType(e.shell,"string"))this._shell=e.shell;else if(!t)throw new TypeError(`'config.shell' is neither a boolean nor a string. type(${typeof e.shell})`);if(Object.prototype.hasOwnProperty.call(e,"windowsVerbatimArguments"))if(c.boolean(e.windowsVerbatimArguments))this._windowsVerbatimArgs=e.windowsVerbatimArguments;else if(!t)throw new TypeError(`'config.windowsVerbatimArguments' is not a boolean. type(${typeof e.windowsVerbatimArguments})`);if(Object.prototype.hasOwnProperty.call(e,"windowsHide"))if(c.boolean(e.windowsHide))this._windowsHide=e.windowsHide;else if(!t)throw new TypeError(`'config.windowsHide' is not a boolean. type(${typeof e.windowsHide})`);if(Object.prototype.hasOwnProperty.call(e,"signal"))if(e.signal instanceof AbortSignal)this._signal=e.signal;else if(!t)throw new TypeError(`'config.signal' is not an AbortSignal type. type(${typeof e.signal})`);if(Object.prototype.hasOwnProperty.call(e,"timeout"))if(c.number(e.timeout))this._timeout=e.timeout;else if(!t)throw new TypeError(`'config.timeout' is not a number type(${typeof e.timeout})`);if(Object.prototype.hasOwnProperty.call(e,"killSignal"))if(c.sameType(e.killSignal,"string")||c.integer(e.killSignal))this._killSignal=e.killSignal;else if(!t)throw new TypeError(`'config.killSignal' is neither a string nor integer type. type(${typeof e.killSignal})`)}else if(!testing)throw new TypeError(`'config' is not an object. type(${typeof e})`)}get CurrentWorkingDirectory(){return this._cwd}get Environment(){return this._env}get ArgV0(){return this._argv0}get StdIo(){return this._stdio}get Detached(){return this._detached}get UID(){return this._uid}get GID(){return this._gid}get Serialization(){return this._serialization}get Shell(){return this._shell}get WindowsVerbatimArguments(){return this._windowsVerbatimArgs}get WindowsHide(){return this._windowsHide}get AbortSignal(){return this._signal}get Timeout(){return this._timeout}get KillSignal(){return this._killSignal}get Data(){return{cwd:this.CurrentWorkingDirectory,env:this.Environment,argv0:this.ArgV0,stdio:this.StdIo,detached:this.Detached,uid:this.UID,gid:this.GID,serialization:this.Serialization,shell:this.Shell,windowsVerbatimArguments:this.WindowsVerbatimArguments,windowsHide:this.WindowsHide,signal:this.AbortSignal,timeout:this.Timeout,killSignal:this.KillSignal}}},p=t("spawn_helper");p.log=console.log.bind(console);const u={EVENT_COMPLETE:"complete"},h=class extends e{constructor(e){if(void 0!==e)throw new TypeError("SpawnHelper does not use any arguments.");super(),this._command=void 0,this._arguments=void 0,this._options=void 0,this._token=void 0,this._result_data=void 0,this._error_data=void 0,this._error_encountered=!1,this._pending=!1,this._CB__process_stdout_data=this._process_stdout_data.bind(this),this._CB__process_stderror_data=this._process_stderror_data.bind(this),this._CB_process_message=this._process_message.bind(this),this._CB_process_error=this._process_error.bind(this),this._CB_process_close=this._process_close.bind(this)}get IsPending(){return this._pending}get IsValid(){return!c.undefined(this.Command)&&!this.IsPending&&!this._error_encountered}get Result(){return this._result_data}get Error(){return this._error_data}get Command(){return this._command}get Arguments(){return this._arguments}get Options(){return this._options}get Token(){return this._token}get Options(){return this._options}Spawn(e){if(this.IsPending)throw new Error("Spawn is already in progress.");if(c.undefined(e)||!c.object(e))throw new TypeError("request must be an object");if(!Object.prototype.hasOwnProperty.call(e,"command")||!c.string(e.command)||e.command.length<=0)throw new TypeError("request.command must be a non-zero length string.");if(this._command=e.command,Object.prototype.hasOwnProperty.call(e,"arguments")){if(!c.array(e.arguments))throw new TypeError("request.arguments must be an array of strings.");for(const t of e.arguments)if(!c.string(t))throw new TypeError("request.arguments must contain only strings.");this._arguments=e.arguments}else this._arguments=[];let t;if(Object.prototype.hasOwnProperty.call(e,"options")){if(!(e.options instanceof d))throw new TypeError("request.options must be an instance of _SpawnOptions.");this._options=e.options,t=e.options.Data}else this._options=void 0;if(Object.prototype.hasOwnProperty.call(e,"token")){if(c.undefined(e.token))throw new TypeError("request.token must be something if it is specified.");this._token=e.token}else this._token=void 0;this._result_data=void 0,this._error_data=void 0,this._error_encountered=!1,this._pending=!0,p(`Spawning command: ${this.Command}`);const n=(0,r.spawn)(this.Command,this.Arguments,t);n.stdout.on("data",this._CB__process_stdout_data),n.stderr.on("data",this._CB__process_stderror_data),n.on("message",this._CB_process_message),n.on("error",this._CB_process_error),n.on("close",this._CB_process_close)}_process_stdout_data(e){c.undefined(this._result_data)?this._result_data=e:this._result_data+=e}_process_stderror_data(e){c.undefined(this._error_data)?this._error_data=e:this._error_data+=e,this._error_encountered=!0}_process_message(e,t){p(`Child Process for ${this.Command}: '${e}'`)}_process_error(e){p(`Child Process for ${this.Command}: error_num:${e.number} error_name:${e.name} error_msg:${e.message}`);let t="";c.not.undefined(this._error_data)&&(t+="\n"),t+=`Error Encountered. err#${e.number} name:${e.name} msg:${e.message}\n`;const r=i.Buffer.from(t,"utf-8");this._process_stderror_data(r)}_process_close(e,t){p(`Child Process for ${this.Command}: exit_code:${e} by signal:'${t}'`),this._pending=!1;const r=this.IsValid,n={valid:r,result:r?this.Result:this.Error,token:this.Token,source:this};this.emit(u.EVENT_COMPLETE,n)}}})();var w=b.RB,v=b.ZP;const C=s("network_target");C.log=console.log.bind(console);const E={URI:"uri",IPV4:"ipv4",IPV6:"ipv6",GATEWAY:"gateway",CABLE_MODEM:"cable_modem"},O={LATENCY:"peak_latency",JITTER:"peak_jitter",LOSS:"peak_packet_loss"},T={LATENCY:"data_latency",JITTER:"data_jitter",LOSS:"data_packet_loss"},S={NONE:0,LATENCY:1,LOSS:2,JITTER:4,ALL:7},D={XFINITY:"xfinity",NETGEAR:"netgear",OTHER:"other"},x={POPULATION:0,SAMPLE:1},A="ready",P="darwin",k="linux";class j extends a{constructor(e){let t=5,r=20,n=1,o=E.URI,i=D.OTHER,s="localhost",a=10,c=1,l=56,p=5,u=432e5,f=180,g=S.ALL;if(void 0!==e){if("object"!=typeof e||void 0!==e.target_type&&"string"!=typeof e.target_type||void 0!==e.modem_type&&"string"!=typeof e.modem_type||void 0!==e.target_dest&&"string"!=typeof e.target_dest||void 0!==e.loss_limit&&"number"!=typeof e.loss_limit||void 0!==e.packet_size&&"number"!=typeof e.packet_size||void 0!==e.ping_period&&"number"!=typeof e.ping_period||void 0!==e.ping_interval&&"number"!=typeof e.ping_count||void 0!==e.ping_count&&"number"!=typeof e.ping_count||void 0!==e.peak_expiration&&"number"!=typeof e.peak_expiration||void 0!==e.expected_latency&&"number"!=typeof e.expected_latency||void 0!==e.expected_jitter&&"number"!=typeof e.expected_jitter||void 0!==e.data_filter_time_window&&"number"!=typeof e.data_filter_time_window||void 0!==e.alert_mask&&"number"!=typeof e.alert_mask)throw new TypeError(`Configuration is invalid: ${e.toString()}`);if(e.target_type){let t=!1;for(const r in E)if(e.target_type.toLowerCase()===E[r]){o=e.target_type.toLowerCase(),t=!0;break}if(!t)throw new RangeError(`config.target_type is invalid: ${e.target_type}`)}if(e.modem_type){let t=!1;for(const r in D)if(e.modem_type.toLowerCase()===D[r]){i=e.modem_type.toLowerCase(),t=!0;break}if(!t)throw new RangeError(`config.modem_type is invalid: ${e.modem_type}`)}if(e.target_dest){if(!(e.target_dest.length>0))throw new RangeError(`config.target_dest is invalid: ${e.target_dest}`);o!==E.GATEWAY&&o!==E.CABLE_MODEM&&(s=e.target_dest)}if(e.loss_limit){if(!(e.loss_limit>=0&&e.loss_limit<=100))throw new RangeError(`Packet Loss limit is undefined or is outside the allowed range. ${e.loss_limit}`);p=e.loss_limit}if(e.packet_size){if(!(e.packet_size>=56))throw new RangeError(`Ping packet size is undefined or is less than the minimum. ${e.packet_size}`);l=e.packet_size}if(e.ping_period){if(!(e.ping_period>=6))throw new RangeError(`Ping period is undefined or is less than the minimum. ${e.ping_period}`);r=e.ping_period}if(e.ping_interval){if(!(e.ping_interval>=1))throw new RangeError(`Ping interval is undefined or is less than the minimum. ${e.ping_interval}`);n=e.ping_interval}if(e.ping_count){if(!(e.ping_count>=3))throw new RangeError(`Ping count is undefined or is less than the minimum. ${e.ping_count}`);t=e.ping_count}if(e.peak_expiration){if(!(e.peak_expiration>=0))throw new RangeError(`Ping expiration time is undefined or is less than the minimum. ${e.peak_expiration}`);u=36e5*e.peak_expiration}if(e.expected_latency){if(!(e.expected_latency>0))throw new RangeError(`config.expected_latency is invalid: ${e.expected_latency}`);a=e.expected_latency}if(e.expected_jitter){if(!(e.expected_jitter>0))throw new RangeError(`config.expected_jitter is invalid: ${e.expected_jitter}`);c=e.expected_jitter}if(e.data_filter_time_window&&(f=e.data_filter_time_window>r?e.data_filter_time_window:r),e.alert_mask){if(!(e.alert_mask>=S.NONE&&e.alert_mask<=S.ALL))throw new RangeError(`config.alert_mask is invalid: ${e.alert_mask}`);g=e.alert_mask}}super(),this._target_type=o,this._modem_type=i,this._target_dest=s,this._ping_count=t,this._loss_limit=p,this._ping_packet_size=l,this._ping_interval=n,this._ping_period=r,this._peak_expiration=u,this._data_buffer_size=Math.floor(f/r),this._expected_latency=a,this._expected_jitter=c,this._alertMask=g,this._timeoutID=-1,this._pingInProgress=!1,this._destination_pending=!1;const m=Date.now();switch(this._peakTime=new Map([[O.LATENCY,m],[O.JITTER,m],[O.LOSS,m]]),this._dataBuffers=new Map([[T.LATENCY,[]],[T.JITTER,[]],[T.LOSS,[]]]),this._CB__initiateCheck=this._on_initiateCheck.bind(this),this._CB__ping=this._on_process_ping.bind(this),this._CB__findGatewayAddr=this._on_find_gateway_address.bind(this),this._target_type){case E.CABLE_MODEM:this._target_type=E.IPV4,this._modem_type===D.XFINITY?this._target_dest="10.0.0.1":this._target_dest="192.168.100.1";break;case E.GATEWAY:{this._target_dest="";const e=new v;e.on(w.EVENT_COMPLETE,this._CB__findGatewayAddr),e.Spawn({command:"route",arguments:this._routeArguments}),this._destination_pending=!0;break}case E.URI:{const e="https://",t="http://";let r=this.TargetDestination.toLowerCase();if(h.not.startWith(r,t)&&h.not.startWith(r,e)&&(r=e+r),h.not.url(r)&&"localhost"!==this.TargetDestination.toLowerCase())throw new RangeError(`Target Destination is not a URI/URL. ${this.TargetDestination}`);break}case E.IPV4:if(h.not.ipv4(this.TargetDestination))throw new RangeError(`Target Destination is not an IPV4. ${this.TargetDestination}`);break;case E.IPV6:if(h.not.ipv6(this.TargetDestination))throw new RangeError(`Target Destination is not an IPV6. ${this.TargetDestination}`);break;default:throw new RangeError(`Unknwon target type. ${this._target_type}`)}const y=d.createHash("sha256");y.update(this._target_type),y.update(this._target_dest),this._id=y.digest("hex")}get ID(){return this._id}get PingCount(){return this._ping_count}get TolerableLoss(){return this._loss_limit}get PacketSize(){return this._ping_packet_size}get PingInterval(){return this._ping_interval}get PingPeriod(){return this._ping_period}get TargetDestination(){return this._target_dest}get TargetType(){return this._target_type}get ModemType(){let e;return this.TargetType===E.CABLE_MODEM&&(e=this._modem_type),e}get ExpectedLatency(){return this._expected_latency}get ExpectedJitter(){return this._expected_jitter}get IsTargetDestinationPending(){return this._destination_pending}IsBufferFilled(e){if(void 0===e||"string"!=typeof e||Object.values(T).indexOf(e)<0)throw new TypeError(`buffer_type not a member of DATA_BUFFER_TYPES. ${e}`);return this._dataBuffers.get(e).length>=this._data_buffer_size}IsPeakExpired(e){if(void 0===e||"string"!=typeof e||Object.values(O).indexOf(e)<0)throw new TypeError(`peak_type not a member of PEAK_TYPES. ${e}`);return Date.now()-this._peakTime.get(e)>this._peak_expiration}UpdatePeakTime(e){if(void 0===e||"string"!=typeof e||Object.values(O).indexOf(e)<0)throw new TypeError(`peak_type not a member of PEAK_TYPES. ${e}`);this._peakTime.set(e,Date.now())}IsAlertActive(e){if(void 0===e||"number"!=typeof e||Object.values(S).indexOf(e)<0)throw new TypeError(`alert_mask not a member of ALERT_BITMASK. ${e}`);return(e&this._alertMask)===e}Start(){this.Stop(),this._reset(),this._on_initiateCheck()}Stop(){-1!==this._timeoutID&&clearTimeout(this._timeoutID)}_reset(){for(const e of this._dataBuffers.keys())do{}while(void 0!==this._dataBuffers.get(e).shift());for(const e of this._peakTime.keys())this._peakTime.set(e,Date.now())}_on_initiateCheck(){let e=1;if(!this._pingInProgress&&this.TargetDestination.length>0){this._pingInProgress=!0;const t=new v;t.on(w.EVENT_COMPLETE,this._CB__ping),t.Spawn({command:"ping",arguments:[`-c${this.PingCount}`,`-i${this.PingInterval}`,`-s${this.PacketSize}`,this.TargetDestination]}),e=1e3*this.PingPeriod}this._timeoutID=setTimeout(this._CB__initiateCheck,e)}_on_process_ping(e){C(`'${e.source.Command} ${e.source.Arguments}' Spawn Helper Result: valid:${e.valid}`),C(e.result);let t=!0;const r=new Map([[T.LATENCY,!0],[T.JITTER,!0],[T.LOSS,!0]]);if(e.valid&&void 0!==e.result){const n=e.result.toString().split("\n"),o="icmp_seq=",i=[];let s=0;for(let e=0;e<n.length;e++)if(n[e].toLowerCase().includes(o)){const t="time=",r=" ms",o=n[e].indexOf(t);if(o>=0){const s=n[e].slice(o+t.length,n[e].length-r.length);i.push(Number.parseFloat(s))}else s+=1}const a=s+i.length;if(t=a<=0,!t){const e=s/a*100;this._dataBuffers.get(T.LOSS).push(e);try{const e=this._computeJitter(i);this._dataBuffers.get(T.JITTER).push(e)}catch(e){}try{const e=this._computeStats(i,x.SAMPLE);this._dataBuffers.get(T.LATENCY).push(e.mean)}catch(e){}this._dataBuffers.forEach(((e,t)=>{e.length<this._data_buffer_size&&r.set(t,!1)}))}}this._dataBuffers.forEach(((e,t)=>{r.get(t)&&e.shift()}));try{const e=this._computeAVT(T.LATENCY),r=this._computeAVT(T.JITTER),n=this._computeAVT(T.LOSS);this.emit(A,{sender:this,error:t,packet_loss:n,ping_latency_ms:e,ping_jitter:r})}catch(e){C(`Error encountered raising 'ready' event. ${e}`)}this._pingInProgress=!1}_on_find_gateway_address(e){if(C(`'${e.source.Command} ${e.source.Arguments}' Spawn Helper Result: valid:${e.valid}`),C(e.result),this._destination_pending=!1,E.GATEWAY===this._target_type)if(e.valid&&void 0!==e.result){const t=e.result.toString().split("\n"),r=process.platform;switch(r.toLowerCase()){case P:this._target_dest=this._extractGatewayOnDarwin(t),C(`Gateway identified: ${this.TargetDestination}`);break;case k:this._target_dest=this._extractGatewayOnLinux(t),C(`Gateway identified: ${this.TargetDestination}`);break;default:C(`Operating system '${r} not supported.`)}}else C(`Gateway not identified: valid=${e.valid} result=${e.result}`);else C(`Target is not a gateway: type=${this._target_type}`)}_extractGatewayOnDarwin(e){const t="gateway: ";let r;if(h.array(e))for(const n of e)if(n.includes(t)){const e=n.indexOf(t);if(e>=0&&n.length>e+9){r=n.substring(e+9);break}}return r}_extractGatewayOnLinux(e){let t;if(h.array(e)&&e.length>2){const r=/\s+/,n=e[1].split(r);if(h.array(n)&&n.length>2){const o=n.findIndex((e=>h.equal(e,"Destination"))),i=n.findIndex((e=>h.equal(e,"Gateway")));if(o>=0&&i>=0){const s=e.slice(2);for(const e of s){const s=e.split(r);if(h.array(s)&&s.length===n.length&&h.equal(s[o],"0.0.0.0")){t=s[i];break}}}}}return t}_computeStats(e,t){if(void 0===e||!Array.isArray(e)||e.length<0)throw new TypeError("data is not an array of numbers.");for(const t of e)if("number"!=typeof t)throw new TypeError("data contains non-numeric items.");if(void 0!==t&&("number"!=typeof t||Object.values(x).indexOf(t)<0))throw new TypeError("type is not an valid.");const r=[].concat(e);r.sort(((e,t)=>e-t));let n=0,o=0,i=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;for(let e=0;e<r.length;e++){const t=r[e],a=n;n+=(t-n)/(e+1),o+=(t-n)*(t-a),t<s&&(s=t),t>i&&(i=t)}const a=t===x.POPULATION?0:1,c=r.length>a?Math.sqrt(o/(r.length-a)):Number.NaN,l=Math.floor(r.length/2),d={mean:n,stddev:c,median:r.length>l?r[l]:0,min:s,max:i,size:r.length};return C("Stats Report:"),C(d),d}_computeAVT(e){if(void 0===e||"string"!=typeof e||Object.values(T).indexOf(e)<0)throw new TypeError(`buffer_type not a member of DATA_BUFFER_TYPES. ${e}`);const t=[].concat(this._dataBuffers.get(e)),r=this._computeStats(t,x.POPULATION);let n=r.median;if(r.stddev!==Number.NaN){const e=r.median-r.stddev,o=r.median+r.stddev,i=[];for(const r of t)r>=e&&r<=o&&i.push(r);n=this._computeStats(i,x.POPULATION).median}return n}_computeJitter(e){if(void 0===e||!Array.isArray(e)||e.length<=0)throw new TypeError("data is not an array of numbers or there is not enough data.");for(const t of e)if("number"!=typeof t)throw new TypeError("data contains non-numeric items.");let t=0;for(let r=1;r<e.length;r++)t+=Math.abs(e[r]-e[r-1]);return e.length>1?t/(e.length-1):0}get _routeArguments(){const e=process.platform;let t;switch(e.toLowerCase()){case P:t=["get","default"];break;case k:t=["-n"];break;case"windows":t=["print","0.0.0.0"];break;default:C(`Operating system '${e} not supported.`)}return t}}class L{constructor(e){if(h.undefined(e)||h.not.object(e)||h.undefined(e.error)||h.not.number(e.error)||h.undefined(e.packet_loss)||h.not.number(e.packet_loss)||h.undefined(e.jitter)||h.not.number(e.jitter)||h.undefined(e.latency)||h.not.number(e.latency)||h.not.undefined(e.date)&&!(e.date instanceof Date))throw new TypeError("Data table configuration is invalid.");if(h.under(e.packet_loss,0)||h.above(e.packet_loss,100)||h.under(e.jitter,0)||h.under(e.latency,0))throw new RangeError("Data table data out of range.");if(this._error=e.error,this._packetLoss=e.packet_loss,this._jitter=e.jitter,this._latency=e.latency,this._date=e.date,h.undefined(e.date)){const e=new Date;this._date=Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}}get Date(){return this._date}get Error(){return this._error}get PacketLoss(){return this._packetLoss}get Jitter(){return this._jitter}get Latency(){return this._latency}}class F{constructor(e){if(h.undefined(e)||h.not.object(e)||h.undefined(e.plugin_version)||h.not.string(e.plugin_version)||h.undefined(e.homebridge_api_version)||h.not.number(e.homebridge_api_version)||h.undefined(e.homebridge_server_version)||h.not.string(e.homebridge_server_version)||h.undefined(e.hap_library_version)||h.not.string(e.hap_library_version)||h.undefined(e.accessory_version)||h.not.number(e.accessory_version))throw new TypeError("Info table configuration is invalid.");if(h.under(e.accessory_version,1))throw new RangeError("Info table data out of range.");this._verPlugIn=e.plugin_version,this._verHomebridgeAPI=e.homebridge_api_version,this._verHomebridgeServer=e.homebridge_server_version,this._verHAPLibrary=e.hap_library_version,this._verAccessory=e.accessory_version}get PlugInVersion(){return this._verPlugIn}get HomebridgeAPIVersion(){return this._verHomebridgeAPI}get HomebridgeServerVersion(){return this._verHomebridgeServer}get HAPLibraryVersion(){return this._verHAPLibrary}get AccessoryVersion(){return this._verAccessory}}const $=(e=>{var t={};return c.d(t,e),t})({access:()=>n.access,constants:()=>n.constants,mkdir:()=>n.mkdir,readdir:()=>n.readdir,rm:()=>n.rm,stat:()=>n.stat,writeFile:()=>n.writeFile}),I=(e=>{var t={};return c.d(t,e),t})({EOL:()=>o.EOL}),N=(e=>{var t={};return c.d(t,e),t})({join:()=>i.join}),R=s("homebridge"),z="homebridge-grumptech-netnanny",M="GrumpTechHomebridgeNetNanny",B="38E010FD-1F45-4C8D-AF2A-D777538D120C",Y={POWER:{uuid:"B3D9583F-2050-43B6-A179-9D453B494220",name:"Ping Control",udst:"PingControl"},LATENCY:{uuid:"9B838A70-8F81-4B76-BED5-3729F8F34F33",name:"Latency",udst:"PingLatency",peak:O.LATENCY,data_buffer:T.LATENCY,alert_mask:S.LATENCY},JITTER:{uuid:"67434B8C-F3CC-44EA-BBE9-15B4E7A2CEBF",name:"Jitter",udst:"PingJitter",peak:O.JITTER,data_buffer:T.JITTER,alert_mask:S.JITTER},LOSS:{uuid:"9093B0DE-078A-4B19-8081-2998B26A9017",name:"Packet Loss",udst:"PacketLoss",peak:O.LOSS,data_buffer:T.LOSS,alert_mask:S.LOSS},EXPORT:{uuid:"E570C0EB-7B9E-4808-8AE1-FA882061057A",name:"Export History",udst:"ExportHistory"}};let V,Z,H,U,J="";class G{constructor(e,t,r){let n;if(this._log=e,this._config=t,this._api=r,this._lastExportTime=-1,this._exportInProgres=!1,this._name=this._config.name,Object.prototype.hasOwnProperty.call(this._config,"settings")&&(n=this._config.settings),this._switchRefresh=void 0,this._bindDoInitialization=this._doInitialization.bind(this),this._bindPingReady=this._processPingReady.bind(this),this._bindDestructorNormal=this._destructor.bind(this,{cleanup:!0}),this._bindDestructorAbnormal=this._destructor.bind(this,{exit:!0}),this._bindExportDatabase=this._on_export_database.bind(this),this._bindResetHistory=this._handleResetDatabase.bind(this),this._log("Creating NetworkPerformanceMonitorPlatform"),this._accessories=new Map,this._networkPerformanceTargets=new Map,this._enableHistoryLogging=!0,this._historyLoggingPeriod=864e5,this._maximumHistorySize=25e4,this._retentionThreshold=2592e6,null!=n){Object.prototype.hasOwnProperty.call(n,"enable_history_logging")&&"boolean"==typeof n.enable_history_logging&&(this._enableHistoryLogging=n.enable_history_logging),Object.prototype.hasOwnProperty.call(n,"history_logging")&&"object"==typeof n.history_logging&&(Object.prototype.hasOwnProperty.call(n.history_logging,"reporting_period")&&"number"==typeof n.history_logging.reporting_period&&(this._historyLoggingPeriod=864e5*n.history_logging.reporting_period),Object.prototype.hasOwnProperty.call(n.history_logging,"maximum_history_size")&&"number"==typeof n.history_logging.maximum_history_size&&(this._maximumHistorySize=n.history_logging.maximum_history_size),Object.prototype.hasOwnProperty.call(n.history_logging,"retention_period")&&"number"==typeof n.history_logging.retention_period&&(this._retentionThreshold=864e5*n.history_logging.retention_period));const e={};if(Object.prototype.hasOwnProperty.call(n,"ping_count")&&"number"==typeof n.ping_count&&(e.ping_count=n.ping_count),Object.prototype.hasOwnProperty.call(n,"packet_size")&&"number"==typeof n.packet_size&&(e.packet_size=n.packet_size),Object.prototype.hasOwnProperty.call(n,"ping_period")&&"number"==typeof n.ping_period&&(e.ping_period=n.ping_period),Object.prototype.hasOwnProperty.call(n,"ping_interval")&&"number"==typeof n.ping_interval&&(e.ping_interval=n.ping_interval),Object.prototype.hasOwnProperty.call(n,"ping_targets")&&Array.isArray(n.ping_targets))for(const t of n.ping_targets){const r=e;if("object"==typeof t){Object.prototype.hasOwnProperty.call(t,"target_type")&&"string"==typeof t.target_type&&(r.target_type=t.target_type),Object.prototype.hasOwnProperty.call(t,"modem_type")&&"string"==typeof t.modem_type&&(r.modem_type=t.modem_type),Object.prototype.hasOwnProperty.call(t,"target_dest")&&"string"==typeof t.target_dest&&(r.target_dest=t.target_dest),Object.prototype.hasOwnProperty.call(t,"expected_latency")&&"number"==typeof t.expected_latency&&(r.expected_latency=t.expected_latency),Object.prototype.hasOwnProperty.call(t,"expected_jitter")&&"number"==typeof t.expected_jitter&&(r.expected_jitter=t.expected_jitter),Object.prototype.hasOwnProperty.call(t,"loss_limit")&&"number"==typeof t.loss_limit&&(r.loss_limit=t.loss_limit),Object.prototype.hasOwnProperty.call(t,"peak_expiration")&&"number"==typeof t.peak_expiration&&(r.peak_expiration=t.peak_expiration),Object.prototype.hasOwnProperty.call(t,"data_filter_time_window")&&"number"==typeof t.data_filter_time_window&&(r.data_filter_time_window=t.data_filter_time_window),Object.prototype.hasOwnProperty.call(t,"sensor_alert_mask")&&"number"==typeof t.sensor_alert_mask&&(r.alert_mask=t.sensor_alert_mask);const e=new j(r);this._networkPerformanceTargets.set(e.ID,e)}}}this._infoTable=void 0,this._historyData=void 0,this._enableHistoryLogging&&(this._infoTable=new F({plugin_version:"1.6.0",homebridge_api_version:V,homebridge_server_version:Z,hap_library_version:U.HAPLibraryVersion(),accessory_version:2}),this._historyData=new Map),this._timeoutIDExportDB=-1,this._api.on("didFinishLaunching",this._bindDoInitialization),this._api.on("shutdown",this._bindDestructorNormal),process.on("exit",this._bindDestructorNormal),process.on("uncaughtException",this._bindDestructorAbnormal)}async _destructor(e,t){console.log("Shutdown"),(e.exit||e.cleanup)&&clearTimeout(this._timeoutIDExportDB)}async _doInitialization(){let e=!1;for(const t of this._networkPerformanceTargets.values())if(t.IsTargetDestinationPending){this._log(`Target ${t.ID} is pending. Defer initialization..`),e=!0;break}if(e)setTimeout(this._doInitialization.bind(this),100);else{this._log(`Homebridge Plug-In ${z} has finished launching.`);const e=[];for(const t of this._accessories.values())Object.prototype.hasOwnProperty.call(t.context,"VERSION")&&2===t.context.VERSION?this._networkPerformanceTargets.has(t.context.ID)||Object.prototype.hasOwnProperty.call(t.context,"TYPE")&&0!=t.context.TYPE||(this._log(`Accessory ${t.displayName} is an orphan and should be purged.`),e.push(t)):(this._log(`Accessory ${t.displayName} has accessory version ${t.context.VERSION}. Version 2 is expected.`),e.push(t));e.forEach((e=>{this._removeAccessory(e)}));for(const e of this._networkPerformanceTargets.values()){this._accessories.has(e.ID)||this._addNetworkPerformanceAccessory(e.ID),e.on(A,this._bindPingReady);const t=this._accessories.get(e.ID);h.not.undefined(this._historyData)&&(this._historyData.has(e.ID)||this._historyData.set(e.ID,[])),this._getAccessorySwitchState(t)&&e.Start()}this._manageGeneralPurposeAccessories(),this._enableHistoryLogging&&(this._timeoutIDExportDB=setTimeout(this._bindExportDatabase,this._historyLoggingPeriod,!1))}}_processPingReady(e){if(!(void 0!==e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"sender")&&e.sender instanceof j&&Object.prototype.hasOwnProperty.call(e,"error")&&"boolean"==typeof e.error&&Object.prototype.hasOwnProperty.call(e,"packet_loss")&&"number"==typeof e.packet_loss&&Object.prototype.hasOwnProperty.call(e,"ping_latency_ms")&&"number"==typeof e.ping_latency_ms&&Object.prototype.hasOwnProperty.call(e,"ping_jitter")&&"number"==typeof e.ping_jitter)){const t=void 0===e?"undefined":e.toString();throw new TypeError(`Ping 'ready' results are invalid: ${t}`)}this._log.debug(`Ping results: Target:${e.sender.TargetDestination} Error:${e.error} Loss:${e.packet_loss} Latency:${e.ping_latency_ms} Jitter:${e.ping_jitter}`);const t=e.sender.ID;if(!this._accessories.has(t))throw this._log.debug(`No accessory for sender ID: ${t}`),new Error(`No accessory for sender ID: ${t}`);{const r=this._accessories.get(t);if(h.not.undefined(r)){const n=e.sender.IsBufferFilled(Y.LATENCY.data_buffer),o=e.sender.IsBufferFilled(Y.JITTER.data_buffer),i=e.sender.IsBufferFilled(Y.LOSS.data_buffer),s=3*e.sender.ExpectedJitter,a=e.error||n&&e.ping_latency_ms>e.sender.ExpectedJitter+s,c=e.error||o&&e.ping_jitter>e.sender.ExpectedJitter,l=e.error||i&&e.packet_loss>e.sender.TolerableLoss,d=e.sender.IsPeakExpired(Y.LATENCY.peak),p=e.sender.IsPeakExpired(Y.JITTER.peak),u=e.sender.IsPeakExpired(Y.LOSS.peak);if(this._updateCarbonDioxideSensorService(r,Y.LATENCY,{level:e.ping_latency_ms,fault:a,resetPeak:d,active:!0}),this._updateCarbonDioxideSensorService(r,Y.JITTER,{level:e.ping_jitter,fault:c,resetPeak:p,active:!0}),this._updateCarbonDioxideSensorService(r,Y.LOSS,{level:e.packet_loss,fault:l,resetPeak:u,active:!0}),h.not.undefined(this._historyData)){const r=Date.now(),n=(a?S.LATENCY:S.NONE)|(c?S.JITTER:S.NONE)|(l?S.LOSS:S.NONE);if(r<this._lastExportTime&&(this._lastExportTime=r[Symbol.toPrimitive]("number")),this._historyData.has(t)){const r=new L({error:n,latency:e.ping_latency_ms,jitter:e.ping_jitter,packet_loss:e.packet_loss}),o=this._historyData.get(t);h.array(o)&&o.push(r)}else this._log.debug(`Target ${t} is not registered.`)}}}}configureAccessory(e){if(void 0===e||!(e instanceof H))throw new TypeError("accessory must be a PlatformAccessory");let t=!1;for(const r of this._accessories.values())if(r===e){t=!0;break}if(!t)try{this._configureAccessory(e)}catch(t){this._log(`Unable to configure accessory ${e.displayName}. Version:${e.context.VERSION}. Error:${t}`);const r=e.context.ID;this._accessories.has(r)||this._accessories.set(r,e)}}_addNetworkPerformanceAccessory(e){if(void 0===e||"string"!=typeof e)throw new TypeError("id must be a string");if(e.length<=0)throw new RangeError("id must be a non-zero length string.");if(this._accessories.has(e))throw new Error(`Accessory '${e}' is already registered.`);if(!this._networkPerformanceTargets.has(e))throw new Error(`No Network Performance Target with id '${e}`);const t=this._networkPerformanceTargets.get(e);this._log.debug(`Adding new accessory: id:'${e}' target:${t.TargetDestination}`);const r=U.uuid.generate(e),n=new H(t.TargetDestination,r);n.context.ID=e,n.context.VERSION=2,n.context.TYPE=0,n.context.SETTINGS={SwitchState:!0},n.addService(U.Service.Switch,Y.POWER.uuid,Y.POWER.udst),n.addService(U.Service.CarbonDioxideSensor,Y.LATENCY.uuid,Y.LATENCY.udst),n.addService(U.Service.CarbonDioxideSensor,Y.JITTER.uuid,Y.JITTER.udst),n.addService(U.Service.CarbonDioxideSensor,Y.LOSS.uuid,Y.LOSS.udst);try{this._configureAccessory(n)}catch(e){this._log.debug("Error when configuring accessory."),this._log.debug(e)}this._api.registerPlatformAccessories(z,M,[n])}_addGeneralPurposeSwitchCollectionAccessory(){if(this._accessories.has(B))throw new Error(`Accessory '${B}' is already registered.`);this._log.debug(`Adding new accessory for a colleciton of general purpose switches: id:'${B}'`);const e=new H("NetNanny Switches",B);e.context.ID=B,e.context.VERSION=2,e.context.TYPE=1,e.context.SETTINGS={SwitchState:!1},e.addService(U.Service.Switch,Y.EXPORT.uuid,Y.EXPORT.udst);try{this._configureAccessory(e)}catch(e){this._log.debug("Error when configuring the general purpose switch collection accessory."),this._log.debug(e)}this._api.registerPlatformAccessories(z,M,[e])}_manageGeneralPurposeAccessories(){this._accessories.has(B)||this._addGeneralPurposeSwitchCollectionAccessory()}_configureAccessory(e){if(void 0===e||!(e instanceof H))throw new TypeError("accessory must be a PlatformAccessory");this._log.debug("Configuring accessory %s",e.displayName);const t=e.context.ID,r=!Object.prototype.hasOwnProperty.call(e.context,"TYPE")||0===e.context.TYPE;e.on(H.PlatformAccessoryEvent.IDENTIFY,(()=>{this._log("%s identified!",e.displayName)}));let n=!0;const o=e.getService(U.Service.Switch);if(void 0!==o&&o instanceof U.Service.Switch){const i=e.context.SETTINGS;void 0!==i&&"object"==typeof i&&Object.prototype.hasOwnProperty.call(i,"SwitchState")&&"boolean"==typeof i.SwitchState&&(n=i.SwitchState),o.updateCharacteristic(U.Characteristic.On,n),r?o.updateCharacteristic(U.Characteristic.Name,`Power (${e.displayName})`):t===B&&o.updateCharacteristic(U.Characteristic.Name,"Export");const s=o.getCharacteristic(U.Characteristic.On);s.on("get",this._handleOnGet.bind(this,t)),B==t?s.on("set",this._handleResetDatabase.bind(this,t)):s.on("set",this._handleOnSet.bind(this,t))}if(r){const t=[Y.LATENCY,Y.JITTER,Y.LOSS];for(const r of t){const t=e.getServiceById(r.uuid,r.udst);void 0!==t&&t.updateCharacteristic(U.Characteristic.Name,`${r.name}-(${e.displayName})`)}this._updateCarbonDioxideSensorService(e,Y.LATENCY,{level:0,fault:!1,resetPeak:!0,active:n}),this._updateCarbonDioxideSensorService(e,Y.JITTER,{level:0,fault:!1,resetPeak:!0,active:n}),this._updateCarbonDioxideSensorService(e,Y.LOSS,{level:0,fault:!1,resetPeak:!0,active:n})}this._updateAccessoryInfo(e,{model:"GrumpTech Network Performance",serialnum:t}),this._accessories.has(t)||(this._log.debug(`Adding accessory '${e.displayName} to the accessories list. Count:${this._accessories.size}`),this._accessories.set(t,e))}_updateCarbonDioxideSensorService(e,t,r){if(void 0===e||!(e instanceof H))throw new TypeError("accessory must be a PlatformAccessory");if(void 0===t||"object"!=typeof t||!Object.prototype.hasOwnProperty.call(t,"uuid")||"string"!=typeof t.uuid||t.uuid.length<=0||!Object.prototype.hasOwnProperty.call(t,"name")||"string"!=typeof t.name||t.name.length<=0||!Object.prototype.hasOwnProperty.call(t,"udst")||"string"!=typeof t.udst||t.udst.length<=0||!Object.prototype.hasOwnProperty.call(t,"peak")||"string"!=typeof t.peak||t.peak.length<=0||!Object.prototype.hasOwnProperty.call(t,"data_buffer")||"string"!=typeof t.data_buffer||t.data_buffer.length<=0||!Object.prototype.hasOwnProperty.call(t,"alert_mask")||"number"!=typeof t.alert_mask)throw new TypeError("serviceName does not conform to a SERVICE_INFO item.");if(void 0===r||"object"!=typeof r||!Object.prototype.hasOwnProperty.call(r,"level")||"number"!=typeof r.level||r.level instanceof Error||!Object.prototype.hasOwnProperty.call(r,"fault")||"boolean"!=typeof r.fault||r.fault instanceof Error||!Object.prototype.hasOwnProperty.call(r,"active")||"boolean"!=typeof r.active||r.active instanceof Error||!Object.prototype.hasOwnProperty.call(r,"resetPeak")||"boolean"!=typeof r.resetPeak||r.resetPeak instanceof Error)throw new TypeError("values must be an object with properties named 'level' (number or Error) and 'fault' (boolean or Error) and 'resetPeak' (boolean or Error)");const n=e.getServiceById(t.uuid,t.udst);if(!(void 0!==n&&n instanceof U.Service.CarbonDioxideSensor))throw this._log.debug(`No service: Accessory ${e.displayName}`),new Error(`Accessory ${e.displayName} does not have a valid ${t.uuid}:${t.udst} service`);try{const o=this._networkPerformanceTargets.get(e.context.ID),i=r.fault?U.Characteristic.StatusFault.GENERAL_FAULT:U.Characteristic.StatusFault.NO_FAULT,s=o.IsAlertActive(t.alert_mask)&&r.fault?U.Characteristic.CarbonDioxideDetected.CO2_LEVELS_ABNORMAL:U.Characteristic.CarbonDioxideDetected.CO2_LEVELS_NORMAL,a=r.active?U.Characteristic.StatusLowBattery.BATTERY_LEVEL_NORMAL:U.Characteristic.StatusLowBattery.BATTERY_LEVEL_LOW;n.updateCharacteristic(U.Characteristic.CarbonDioxideDetected,s),r.level>=0&&n.updateCharacteristic(U.Characteristic.CarbonDioxideLevel,r.level),n.updateCharacteristic(U.Characteristic.StatusFault,i),n.updateCharacteristic(U.Characteristic.StatusLowBattery,a),n.updateCharacteristic(U.Characteristic.StatusActive,r.active);const c=n.getCharacteristic(U.Characteristic.CarbonDioxidePeakLevel).value;(r.resetPeak||r.level>c)&&(n.updateCharacteristic(U.Characteristic.CarbonDioxidePeakLevel,r.level),void 0!==o&&o.UpdatePeakTime(t.peak))}catch(t){this._log.debug(`Error setting characteristics for ${e.displayName}. Error: ${t}`)}}_removeAccessory(e){if(void 0===e||!(e instanceof H))throw new TypeError("Accessory must be a PlatformAccessory");if(!this._accessories.has(e.context.ID))throw new RangeError(`Accessory '${e.displayName}' is not registered.`);this._log.debug(`Removing accessory '${e.displayName}'`);const t=e.context.ID;e.removeAllListeners(H.PlatformAccessoryEvent.IDENTIFY);const r=e.getService(U.Service.Switch);if(void 0!==r){const e=r.getCharacteristic(U.Characteristic.On);e.off("get",this._handleOnGet.bind(this,t)),B==t?e.off("set",this._handleResetDatabase.bind(this,t)):e.off("set",this._handleOnSet.bind(this,t))}this._api.unregisterPlatformAccessories(z,M,[e]),this._accessories.delete(t)}_updateAccessoryInfo(e,t){if(void 0===e||!(e instanceof H))throw new TypeError("Accessory must be a PlatformAccessory");if(void 0===t||!Object.prototype.hasOwnProperty.call(t,"model")||"string"!=typeof t.model||t.model instanceof Error||!Object.prototype.hasOwnProperty.call(t,"serialnum")||"string"!=typeof t.serialnum||t.serialnum instanceof Error)throw new TypeError("info must be an object with properties named 'model' and 'serialnum' that are eother strings or Error");const r=e.getService(U.Service.AccessoryInformation);null!=r&&(r.updateCharacteristic(U.Characteristic.Manufacturer,"GrumpTech"),r.updateCharacteristic(U.Characteristic.Model,t.model),r.updateCharacteristic(U.Characteristic.SerialNumber,t.serialnum),r.updateCharacteristic(U.Characteristic.SoftwareRevision,`v${e.context.VERSION}`))}_handleOnGet(e,t){if(void 0===e||"string"!=typeof e||e.length<=0)throw new TypeError("id must be a non-zero length string.");let r=null,n=new Error("not handled");if(!this._accessories.has(e))throw new Error(`id:${e} has no matching accessory`);{const t=this._accessories.get(e);this._log.debug(`Ping Power '${t.displayName}' Get Request.`);try{n=this._getAccessorySwitchState(t)}catch(e){this._log.debug(`  Unexpected error encountered: ${e.message}`),n=!1,r=new Error(`Accessory ${t.displayName} is not ressponding.`)}}t(r,n)}_handleOnSet(e,t,r){if(void 0===e||"string"!=typeof e||e.length<=0)throw new TypeError("id must be a non-zero length string.");let n=null;if(!this._accessories.has(e))throw new Error(`id:${e} has no matching accessory`);{const r=this._accessories.get(e);this._log.debug(`Ping Power '${r.displayName}' Set Request. New state:${t}`);const o=this._networkPerformanceTargets.has(e);if(o){const e=r.context.SETTINGS;void 0!==e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"SwitchState")&&"boolean"==typeof e.SwitchState&&(e.SwitchState=t),r.context.SETTINGS=e}try{if(!o)throw new Error(`id:${e} has no matching network performance target nor any other accessories.`);{const n=this._networkPerformanceTargets.get(e);if(void 0!==n){const e=t?0:-1;this._updateCarbonDioxideSensorService(r,Y.LATENCY,{level:e,fault:!1,resetPeak:t,active:t}),this._updateCarbonDioxideSensorService(r,Y.JITTER,{level:e,fault:!1,resetPeak:t,active:t}),this._updateCarbonDioxideSensorService(r,Y.LOSS,{level:e,fault:!1,resetPeak:t,active:t}),t?n.Start():n.Stop()}}}catch(e){this._log.debug(`  Unexpected error encountered: ${e.message}`),n=new Error(`Accessory ${r.displayName} is not ressponding.`)}}r(n)}_handleResetDatabase(e,t,r){if(this._log.debug(`Reset Database New state:${t}`),B==e){const e=this._accessories.get(B),n=e.getService(U.Service.Switch),o=this._getAccessorySwitchState(e);this._enableHistoryLogging?h.boolean(t)?(this._exportInProgres?t&&(this._log.debug("Export in progres. Ignoring the request to reset the database."),setTimeout((e=>{h.null(e)||(this._log.debug(`Switch '${e.displayName}' forcing off`),e.updateCharacteristic(U.Characteristic.On,!1))}),500,n)):t&&!o&&(clearTimeout(this._timeoutIDExportDB),this._lastExportTime=-1,this._timeoutIDExportDB=setImmediate(this._bindExportDatabase,!0),setTimeout((e=>{h.null(e)||(this._log.debug(`Switch '${e.displayName}' forcing off`),e.updateCharacteristic(U.Characteristic.On,!1))}),500,n)),r(null)):r(new TypeError("value is invalid.")):(t&&setTimeout((e=>{h.null(e)||(this._log.debug(`Switch '${e.displayName}' forcing off`),e.updateCharacteristic(U.Characteristic.On,!1))}),500,n),r(null))}else r(new RangeError("id is invalid."))}_getAccessorySwitchState(e){if(void 0===e||!(e instanceof H))throw new TypeError("Accessory must be a PlatformAccessory");let t=!1;const r=e.getService(U.Service.Switch);if(void 0===r)throw new Error(`Accessory ${e.displayName} does not have a Switch service.`);{const n=r.getCharacteristic(U.Characteristic.On);if(void 0===n)throw new Error(`The Switch service of accessory ${e.displayName} does not have an On charactristic.`);t=n.value}return t}_trimHistoryTables(e){h.integer(e)&&h.gt(e,0)&&h.not.undefined(this._historyData)&&this._historyData.foreach(((t,r,n)=>{const o=t.length;if(o>e){const i=Math.ceil(1.02*(o-e)),s=t.toSpliced(0,i);n.push(r,s)}}))}async _on_export_database(e){const t="History_",r=".csv";if(h.not.boolean(e))throw new TypeError("'flushHistory' must be a boolean.");if((0,$.readdir)(J,((e,n)=>{h.null(e)?h.array(n)&&n.forEach((e=>{if(h.string(e)&&h.startWith(e,t)&&h.endWith(e,r)){const t=(0,N.join)(J,e);(0,$.stat)(t,((r,n)=>{h.null(r)?Date.now()-n.mtimeMs>this._retentionThreshold&&(this._log.debug(`Removing file: ${e}`),(0,$.rm)(t,(t=>{h.not.null(t)&&(this._log.debug(`Error removing file: ${e}`),this._log.debug(t))}))):(this._log.debug("Error encountered (status):"),this._log.debug(r))}))}})):(this._log.debug("Error encountered (readdir):"),this._log.debug(e))})),h.not.undefined(this._historyData)){const n=new Date(Date.now());this._exportInProgres=!0;const o=(0,N.join)(J,`${t}${n.getTime()}${r}`);this._log.debug(`Exporting database: ${o}`);let i="";i+=`timestamp:,${n.toDateString()} @ ${n.toTimeString()}${I.EOL}`,i+=`plugin version:,${this._infoTable.PlugInVersion}${I.EOL}`,i+=`homebridge api version:,${this._infoTable.HomebridgeAPIVersion}${I.EOL}`,i+=`homebridge server version:,${this._infoTable.HomebridgeServerVersion}${I.EOL}`,i+=`hap library version:,${this._infoTable.HAPLibraryVersion}${I.EOL}`,i+=`node.js version:,${process.versions.node}${I.EOL}`,i+=`accessory version:,${this._infoTable.AccessoryVersion}${I.EOL}`,i+=I.EOL;const s=[];this._historyData.forEach(((e,t)=>{this._networkPerformanceTargets.has(t)?h.not.undefined(e)?e.forEach((e=>{if(e.Date>this._lastExportTime){const r=this._networkPerformanceTargets.get(t);s.push({date:e.Date,name:r.TargetDestination,type:r.TargetType,latency:e.Latency,jitter:e.Jitter,loss:e.PacketLoss,fault:e.Error})}})):this._log.debug(`Export - No Data: ${t}`):this._log.debug(`Export - Unknown target: ${t}`)})),s.sort(((e,t)=>e.date-t.date)),s.length>0&&(i+=`date,raw time (ms),name,type,latency (ms),jitter (ms),loss,fault code (bitmask)${I.EOL}`,s.forEach((e=>{const t=new Date(e.date);i+=`${t.toDateString()} @ ${t.toTimeString()},${e.date},${e.name},${e.type},${e.latency},${e.jitter},${e.loss},${e.fault}${I.EOL}`})),(0,$.writeFile)(o,i,(e=>{h.null(e)||(this._log.debug("Error exporting history:"),this._log.debug(e))})),this._lastExportTime=s[s.length-1].date,e&&this._historyData.forEach((e=>{e.splice(0,e.length)}))),this._exportInProgres=!1,this._timeoutIDExportDB=setTimeout(this._bindExportDatabase,this._historyLoggingPeriod,!1)}}}const W=e=>{if(V=e.version,Z=e.serverVersion,R(`homebridge API version: v${V}`),R(`homebridge Server version: v${Z}`),J=(0,N.join)(e.user.customStoragePath,M),(0,$.access)(J,$.constants.F_OK,(e=>{h.null(e)||(0,$.mkdir)(J,(e=>{h.null(e)||(R("Unable to create plugin storage folder."),R(e))}))})),H=e.platformAccessory,!Object.prototype.hasOwnProperty.call(H,"PlatformAccessoryEvent")){const e={IDENTIFY:"identify"};H.PlatformAccessoryEvent=e}U=e.hap,R(`Registering platform: ${M}`),e.registerPlatform(M,G)}})();var d=l.Z;export{d as default};